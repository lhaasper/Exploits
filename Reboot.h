// by: Opensource.apple.com
// thx apple for giving us the chance to make exploits.
//  {file}
//
//  Created by lhaasper
//  Copyright Â© lhaasper. All rights reserved.
//

#ifndef    _SYS_REBOOT_H_
#define _SYS_REBOOT_H_

#include <sys/appleapiopts.h>
#include <sys/cdefs.h>
#include <stdint.h>

/*
 * Arguments to reboot system call.
 */

#ifdef __APPLE_API_PRIVATE
#define RB_AUTOBOOT    0    /* flags for system auto-booting itself */

#define RB_ASKNAME    0x01    /* ask for file name to reboot from */
#define RB_SINGLE    0x02    /* reboot to single user only */
#define RB_NOSYNC    0x04    /* dont sync before reboot */
#define RB_HALT        0x08    /* don't reboot, just halt */
#define RB_INITNAME    0x10    /* name given for /etc/init */
#define RB_DFLTROOT    0x20    /* use compiled-in rootdev */
#define RB_ALTBOOT    0x40    /* use /boot.old vs /boot */
#define RB_UNIPROC    0x80    /* don't start slaves */
#define RB_SAFEBOOT    0x100    /* booting safe */
#define RB_UPSDELAY 0x200   /* Delays restart by 5 minutes */
#define RB_QUICK    0x400    /* quick and ungraceful reboot with file system caches flushed*/
#define RB_PANIC    0x800   /* panic the kernel */

#ifndef KERNEL
__BEGIN_DECLS
/* userspace reboot control */
int usrctl(uint32_t flags);
/* The normal reboot syscall. */
int reboot(int howto);
/* Used with RB_PANIC to panic the kernel from userspace with a message.
 * Requires an entitlement on Release. */
int reboot_np(int howto, const char *message);
__END_DECLS
#endif

#endif /* __APPLE_API_PRIVATE */

#ifdef __APPLE_API_OBSOLETE
/*
 * Constants for converting boot-style device number to type,
 * adaptor (uba, mba, etc), unit number and partition number.
 * Type (== major device number) is in the low byte
 * for backward compatibility.  Except for that of the "magic
 * number", each mask applies to the shifted value.
 * Format:
 *     (4) (4) (4) (4)  (8)     (8)
 *    --------------------------------
 *    |MA | AD| CT| UN| PART  | TYPE |
 *    --------------------------------
 */
#define B_ADAPTORSHIFT    24
#define B_ADAPTORMASK    0x0f
#define    B_ADAPTOR(val)        (((val) >> B_ADAPTORSHIFT) & B_ADAPTORMASK)
#define B_CONTROLLERSHIFT    20
#define B_CONTROLLERMASK    0xf
#define    B_CONTROLLER(val)    (((val)>>B_CONTROLLERSHIFT) & B_CONTROLLERMASK)
#define B_UNITSHIFT    16
#define B_UNITMASK    0xff
#define    B_UNIT(val)        (((val) >> B_UNITSHIFT) & B_UNITMASK)
#define B_PARTITIONSHIFT 8
#define B_PARTITIONMASK    0xff
#define    B_PARTITION(val)    (((val) >> B_PARTITIONSHIFT) & B_PARTITIONMASK)
#define B_TYPESHIFT    0
#define B_TYPEMASK    0xff
#define    B_TYPE(val)        (((val) >> B_TYPESHIFT) & B_TYPEMASK)
#define B_MAGICMASK    0xf0000000
#define B_DEVMAGIC    0xa0000000

#define MAKEBOOTDEV(type, adaptor, controller, unit, partition) \
(((type) << B_TYPESHIFT) | ((adaptor) << B_ADAPTORSHIFT) | \
((controller) << B_CONTROLLERSHIFT) | ((unit) << B_UNITSHIFT) | \
((partition) << B_PARTITIONSHIFT) | B_DEVMAGIC)

#endif /* __APPLE_API_OBSOLETE */

#endif    /* _SYS_REBOOT_H_ */
